<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jkraise.top","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Django 商业电商 网站知识点 B2B–企业对企业 C2C–个人对个人 B2C–企业对个人 C2B–个人对企业">
<meta property="og:type" content="article">
<meta property="og:title" content="Django 知识点">
<meta property="og:url" content="http://jkraise.top/2021/06/21/Django-knowledge%20point/index.html">
<meta property="og:site_name" content="ZK&#96;s Blog">
<meta property="og:description" content="Django 商业电商 网站知识点 B2B–企业对企业 C2C–个人对个人 B2C–企业对个人 C2B–个人对企业">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1623057663949.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1622039303627.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/image-20210608220332914.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/image-20210608220404402.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1623247171683.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1623247333771.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1623760067968.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1623849155977.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1623849799894.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1623854721035.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1623854396821.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1623897517610.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1623898018991.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1623999276975.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1624000128281.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1624000331193.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1624234856277.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1624326579016.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1624408527701.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1625022115613.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1626680437193.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1626680526839.png">
<meta property="og:image" content="https://qny.jkraise.top/Django-knowledge/1626680712990.png">
<meta property="article:published_time" content="2021-06-21T12:05:00.000Z">
<meta property="article:modified_time" content="2021-09-07T11:34:25.100Z">
<meta property="article:author" content="zhaokui">
<meta property="article:tag" content="Django">
<meta property="article:tag" content="商业模式">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://qny.jkraise.top/Django-knowledge/1623057663949.png">

<link rel="canonical" href="http://jkraise.top/2021/06/21/Django-knowledge%20point/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Django 知识点 | ZK`s Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="ZK`s Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
    <a target="_blank" rel="noopener" href="https://github.com/joinik?tab=repositories" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ZK`s Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">zhaokui</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="calendar fa-fw"></i>日程表</a>

  </li>
        <li class="menu-item menu-item-friends">

    <a href="/friends/" rel="section"><i class="friend fa-fw"></i>friends</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="sitemap fa-fw"></i>站点地图</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://jkraise.top/2021/06/21/Django-knowledge%20point/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="zhaokui">
      <meta itemprop="description" content="There is something inside ,that they can'tgetto,that they can't touch. hat's yours.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZK`s Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Django 知识点
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-06-21 20:05:00" itemprop="dateCreated datePublished" datetime="2021-06-21T20:05:00+08:00">2021-06-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-09-07 19:34:25" itemprop="dateModified" datetime="2021-09-07T19:34:25+08:00">2021-09-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Django/" itemprop="url" rel="index"><span itemprop="name">Django</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Django/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/06/21/Django-knowledge%20point/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/06/21/Django-knowledge%20point/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>23k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>21 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Django 商业电商 网站知识点</p>
<p>B2B–企业对企业</p>
<p>C2C–个人对个人</p>
<p>B2C–企业对个人</p>
<p>C2B–个人对企业</p>
<a id="more"></a>

<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><p>@<a href="#%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E4%BB%8B%E7%BB%8D">1.商业模式介绍</a></p>
<p><a href="#2">2项目知识点</a></p>
<h3 id="商业模式介绍"><a href="#商业模式介绍" class="headerlink" title="商业模式介绍"></a>商业模式介绍</h3><h4 id="1-B2B–企业对企业"><a href="#1-B2B–企业对企业" class="headerlink" title="1. B2B–企业对企业"></a>1. B2B–企业对企业</h4><p> B2B平台是电子商务的一种模式，是英文Business-to-Business的缩写，即商业对商业，或者说是企业间的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%94%B5%E5%AD%90%E5%95%86%E5%8A%A1/98106">电子商务</a>，即企业与企业之间通过<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%BA%92%E8%81%94%E7%BD%91/199186">互联网</a>进行产品、服务及信息的交换。它将企业内部网，通过<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/B2B%E7%BD%91%E7%AB%99/7996327">B2B网站</a>与客户紧密结合起来，通过网络的快速反应，为客户提供更好的服务，从而促进企业的业务发展 </p>
<p><strong>案例</strong> 阿里巴巴，</p>
<h4 id="2-C2C–个人对个人"><a href="#2-C2C–个人对个人" class="headerlink" title="2. C2C–个人对个人"></a>2. C2C–个人对个人</h4><p> 通过电子商务网站为买卖用户双方提供一个<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%9C%A8%E7%BA%BF%E4%BA%A4%E6%98%93%E5%B9%B3%E5%8F%B0/12751437">在线交易平台</a>，使卖方可以在上面发布待出售的物品的信息，而买方可以从中选择进行购买，同时，为便于<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%B9%B0%E5%8D%96/1177192">买卖</a>双方交易，提供交易所需的一系列配套服务。如：协调市场信息汇集、建立信用评价制度、多种付款方式 </p>
<p><strong>案例</strong> 淘宝，闲鱼，瓜子二手车</p>
<h4 id="3-B2C–企业对个人"><a href="#3-B2C–企业对个人" class="headerlink" title="3. B2C–企业对个人"></a>3. B2C–企业对个人</h4><p>B2C是Business to Customer的缩写，而其中文简称为“商对客”。“商对客”是电子商务的一种模式，也就是通常说的直接面向消费者销售产品和服务商业零售模式·这种形式的电子商务一般以网络零售业为主，主要借助于互联网开展在线销售活动·B2C即企业通过互联网为消费者提供一个新型的购物环境<br>—-网上商店，消费者通过网络在网上购物、网上支付等消费行为。</p>
<p><strong>案例</strong> 唯品会，</p>
<h4 id="4-C2B–个人对企业"><a href="#4-C2B–个人对企业" class="headerlink" title="4.C2B–个人对企业"></a>4.C2B–个人对企业</h4><p>·C2B（Consumer to Business，即消费者到企业），是互联网经济时代新的商业模式。这一模式改变了原有生产者（企业和机构）和消费者的关系，是一种消费者贡献价值（Create Value），企业和机构消费价值（Consume Value）。C2B模式和我们熟知的供需模式（DSM，Demand Supply Model）恰恰相反，真正的C2B应该先有消费者需求产生而后有企业生产，即先有消费者提出需求，后有生产企业按需求组织生产。通常情况为消费者根据自身需求定制产品和价格，或主动参与产品设计、生产和定价，产品、价格等彰显消费者的个性化需求，生产企业进行定制化生产。</p>
<p><strong>案例</strong> 海尔商场，商品宅派</p>
<h3 id="项目知识点"><a href="#项目知识点" class="headerlink" title="项目知识点"></a><a id="2">项目知识点</a></h3><h4 id="live-server实时简易静态服务器"><a href="#live-server实时简易静态服务器" class="headerlink" title="live-server实时简易静态服务器"></a>live-server实时简易静态服务器</h4><p> <strong>Live Server</strong>：一个具有实时加载功能的小型服务器，可以使用它来破解html/css/javascript，但是不能用于部署最终站点。也就是说我们可以在项目中实时用live-server作为一个实时服务器实时查看开发的网页或项目效果。 </p>
<p><strong>安装</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g live-server</span><br></pre></td></tr></table></figure>

<p> 在所在项目目录下，打开命令行工具，输入 live-server，回车就可以了（注意这里默认打开的是index.html）。 </p>
<p>默认端口 8080  可以指定端口 9000</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">live-server --port 9000</span><br></pre></td></tr></table></figure>



<h4 id="ubuntu-设置默认IP地址"><a href="#ubuntu-设置默认IP地址" class="headerlink" title="ubuntu  设置默认IP地址"></a>ubuntu  设置默认IP地址</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">设置 wired</span><br><span class="line"></span><br><span class="line">ipv4 </span><br><span class="line">手动设置</span><br><span class="line">A类 10.0.0.0--10.255.255.255</span><br><span class="line">B类 172.16.0.0--172.31.255.255</span><br><span class="line">C类 192.168.0.0--192.168.255.255</span><br><span class="line"></span><br><span class="line">Address 默认为ubuntu 的ip  用ifconfig 查看</span><br><span class="line">Netmask c类 子网掩码 255.255.255.0 </span><br><span class="line">gateway 网关 192.168.17.2</span><br><span class="line">dns 114.114.114.114,119.29.29.29</span><br></pre></td></tr></table></figure>

<p><img src="https://qny.jkraise.top/Django-knowledge/1623057663949.png" alt="1623057663949"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yuanbinquan/article/details/52963845">详情请到这里面</a></p>
<h4 id="Django自定义文件存储类"><a href="#Django自定义文件存储类" class="headerlink" title="Django自定义文件存储类"></a>Django自定义文件存储类</h4><p><strong>注意</strong></p>
<ul>
<li>必须重写的 <code>_open</code> 方法，<code>_save</code>方法 </li>
<li><code>url</code>方法 用来访问文件</li>
<li><code>exists</code>方法用来判断文件名是否重复，</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">继承Storage必须实现_open()和_save()方法</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FastDFSStorage</span>(<span class="params">Storage</span>):</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, client_path=None, base_url=None</span>):</span></span><br><span class="line">        <span class="comment"># fastDFS的客户端配置文件路径</span></span><br><span class="line">        self.client_path = client_path <span class="keyword">or</span> settings.FDFS_CLIENT_CONF</span><br><span class="line">        <span class="comment"># storage服务器ip:端口</span></span><br><span class="line">        self.base_url = base_url <span class="keyword">or</span> settings.FDFS_BASE_URL</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_open</span>(<span class="params">self, name, mode=<span class="string">&#x27;rb&#x27;</span></span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        用来打开文件的,但是我们自定义文件存储系统的目的是为了实现存储到远程的FastDFS服务器,不需要打开文件,所以此方重写后什么也不做pass</span></span><br><span class="line"><span class="string">        :param name: 要打开的文件名</span></span><br><span class="line"><span class="string">        :param mode: 打开文件的模式  read bytes</span></span><br><span class="line"><span class="string">        :return: None</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_save</span>(<span class="params">self, name, content</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        文件存储时什么调用此方法,但是此方法默认是向本地存储,在此方法做实现文件存储到远程的FastDFS服务器</span></span><br><span class="line"><span class="string">        :param name: 要上传的文件名</span></span><br><span class="line"><span class="string">        :param content: 以rb模式打开的文件对象 将来通过content.read() 就可以读取到文件的二进制数据</span></span><br><span class="line"><span class="string">        :return: file_id</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 1.创建FastDFS 客户端</span></span><br><span class="line">        <span class="comment"># client = Fdfs_client(&#x27;meiduo_mall/utils/fastdfs/client.conf&#x27;)</span></span><br><span class="line">        <span class="comment"># client = Fdfs_client(settings.FDFS_CLIENT_CONF)</span></span><br><span class="line">        client = Fdfs_client(self.client_path)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2.通过客户端调用上传文件的方法上传文件到fastDFS服务器</span></span><br><span class="line">        <span class="comment"># client.upload_by_filename(&#x27;要写上传文件的绝对路径&#x27;) 只能通过文件绝对路径进行上传  此方式上传的文件会有后缀</span></span><br><span class="line">        <span class="comment"># upload_by_buffer 可以通过文件二进制数据进行上传  上传后的文件没有后缀</span></span><br><span class="line">        ret = client.upload_by_buffer(content.read())</span><br><span class="line">        <span class="comment"># 3.判断文件是否上传成功</span></span><br><span class="line">        <span class="keyword">if</span> ret.get(<span class="string">&#x27;Status&#x27;</span>) != <span class="string">&#x27;Upload successed.&#x27;</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;Upload file failed&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3.1 获取file_id</span></span><br><span class="line">        file_id = ret.get(<span class="string">&#x27;Remote file_id&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 4.返回file_id</span></span><br><span class="line">        <span class="keyword">return</span> file_id</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">exists</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        当要进行上传时都调用此方法判断文件是否已上传,如果没有上传才会调用save方法进行上传</span></span><br><span class="line"><span class="string">        :param name: 要上传的文件名</span></span><br><span class="line"><span class="string">        :return: True(表示文件已存在,不需要上传)  False(文件不存在,需要上传)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">url</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        当要访问图片时,就会调用此方法获取图片文件的绝对路径</span></span><br><span class="line"><span class="string">        :param name: 要访问图片的file_id</span></span><br><span class="line"><span class="string">        :return: 完整的图片访问路径: storage_server IP:8888 + file_id</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># return &#x27;http://xxx.xxx.xxx.xx:8888/&#x27; + name</span></span><br><span class="line">        <span class="comment"># return settings.FDFS_BASE_URL + name</span></span><br><span class="line">        <span class="keyword">return</span> self.base_url + name</span><br></pre></td></tr></table></figure>

<ul>
<li><p>在Django中setting文件设置三个变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 指定Django使用的文件存储类 ，上面编写的py文件的路径</span><br><span class="line">DEFAULT_FILE_STORAGE &#x3D; &#39;utils.fdfs.storage.FastDFSStorage&#39;</span><br><span class="line"># 设置fdfs使用的client.conf文件路径 ，变量名自己取，与上面的py文件一致</span><br><span class="line">FDFS_CLIENT_CONF &#x3D; &#39;.&#x2F;utils&#x2F;fdfs&#x2F;client.conf&#39;</span><br><span class="line"># 设置fdfs存储服务器ngibx的ip和端口号，变量名自己取，与上面的py文件一致</span><br><span class="line">FDFS_URL &#x3D; &#39;http:&#x2F;&#x2F;xxx.xxx.xxx.xx:8888&#x2F;&#39;</span><br></pre></td></tr></table></figure>
</li>
<li><p><a target="_blank" rel="noopener" href="https://docs.djangoproject.com/zh-hans/2.2/howto/custom-file-storage/">具体见官方文档</a> <a target="_blank" rel="noopener" href="https://docs.djangoproject.com/zh-hans/2.2/howto/custom-file-storage/">https://docs.djangoproject.com/zh-hans/2.2/howto/custom-file-storage/</a></p>
</li>
<li></li>
</ul>
<h4 id="CKEditor-富文本编辑器"><a href="#CKEditor-富文本编辑器" class="headerlink" title="CKEditor 富文本编辑器"></a>CKEditor 富文本编辑器</h4><ul>
<li><p>安装<code>pip install django-ckeditor</code></p>
</li>
<li><p>注册应用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS &#x3D; [</span><br><span class="line">	......</span><br><span class="line">	&#39;ckeditor&#39;,  # 富⽂文本编辑器器</span><br><span class="line">	&#39;ckeditor_uploader&#39;,  # 富⽂文本编辑器器上传图⽚片模块</span><br><span class="line">	......</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>加载配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 富⽂文本编辑器器ckeditor配置</span><br><span class="line">CKEDITOR_CONFIGS &#x3D; &#123;</span><br><span class="line">    &#39;default&#39;: &#123;</span><br><span class="line">        &#39;toolbar&#39;: &#39;full&#39;,  # ⼯工具条功能</span><br><span class="line">        &#39;height&#39;: 300,  # 编辑器器⾼高度        </span><br><span class="line">        &#39;width&#39;: 300,  # 编辑器器宽</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line">CKEDITOR_UPLOAD_PATH &#x3D; &#39;&#39;  # 上传图⽚片保存路路径，使⽤用了了FastDFS，所以此处设为&#39;&#39;</span><br></pre></td></tr></table></figure>
</li>
<li><p>注册总路由</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">re_path(r&#39;^ckeditor&#x2F;&#39;, include(&#39;ckeditor_uploader.urls&#39;)),</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>模型类补充富⽂文本字段 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">desc_detail &#x3D; RichTextUploadingField(default&#x3D;&#39;&#39;, verbose_name&#x3D;&#39;详细介绍&#39;)</span><br><span class="line">  desc_pack &#x3D; RichTextField(default&#x3D;&#39;&#39;, verbose_name&#x3D;&#39;包装信息&#39;)</span><br><span class="line">  desc_service &#x3D; RichTextUploadingField(default&#x3D;&#39;&#39;, verbose_name&#x3D;&#39;售后服务&#39;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>修复bug适配FastDFS </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if len(str(saved_path).split(&#39;.&#39;)) &gt; 1:</span><br><span class="line">           if(str(saved_path).split(&#39;.&#39;)[1].lower() !&#x3D; &#39;gif&#39;): self._create_thumbnail_if_needed(backend, saved_path)</span><br><span class="line">  </span><br></pre></td></tr></table></figure>



</li>
</ul>
<h4 id="搜索引擎-全文检索方案Elasticsearch"><a href="#搜索引擎-全文检索方案Elasticsearch" class="headerlink" title="搜索引擎(全文检索方案Elasticsearch)"></a>搜索引擎(全文检索方案Elasticsearch)</h4><blockquote>
<p><strong>实现全文检索的搜索引擎，首选的是</strong><code>Elasticsearch</code><strong>。</strong></p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.elastic.co/">Elasticsearch</a>是用 Java 实现的，开源的搜索引擎。</li>
<li>它可以快速地储存、搜索和分析海量数据。维基百科、Stack Overflow、Github等都采用它。</li>
<li>Elasticsearch 的底层是开源库<a target="_blank" rel="noopener" href="https://lucene.apache.org/">Lucene</a> 。但是，没法直接使用 Lucene，必须自己写代码去调用它的接口。</li>
</ul>
<blockquote>
<p><strong>分词说明</strong></p>
</blockquote>
<ul>
<li><p>搜索引擎在对数据构建索引时，需要进行分词处理。</p>
</li>
<li><p>分词是指将一句话拆解成<strong>多个单字</strong>或<strong>词</strong>，这些字或词便是这句话的关键词。</p>
</li>
<li><p>比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我是中国人</span><br></pre></td></tr></table></figure>

<ul>
<li>分词后：<code>我</code>、<code>是</code>、<code>中</code>、<code>国</code>、<code>人</code>、<code>中国</code>等等都可以是这句话的关键字。</li>
</ul>
</li>
<li><p>Elasticsearch 不支持对中文进行分词建立索引，需要配合扩展<code>elasticsearch-analysis-ik</code>来实现中文分词处理。</p>
</li>
</ul>
<ol>
<li><h3 id="使用Docker安装Elasticsearch"><a href="#使用Docker安装Elasticsearch" class="headerlink" title="使用Docker安装Elasticsearch"></a>使用Docker安装Elasticsearch</h3><blockquote>
<p><strong>1.获取Elasticsearch-ik镜像</strong></p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从仓库拉取镜像</span></span><br><span class="line">$ sudo docker image pull delron/elasticsearch-ik:<span class="number">2.4</span><span class="number">.6</span><span class="number">-1.0</span></span><br><span class="line"><span class="comment"># 本地镜像</span></span><br><span class="line">$ sudo docker load -i elasticsearch-ik<span class="number">-2.4</span><span class="number">.6</span>_docker.tar</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>2.配置Elasticsearch-ik</strong> </p>
</blockquote>
<ul>
<li><p><code>elasticsearc-2.4.6</code>目录拷贝到<code>home</code>目录下 </p>
</li>
<li><p>修改<code>/home/ubuntu/Desktop/elasticsearc-2.4.6/config/elasticsearch.yml</code>第54行。</p>
</li>
<li><p>更改ip地址为本机真实ip地址。</p>
</li>
</ul>
<blockquote>
<p><strong>3.使用Docker运行Elasticsearch-ik</strong></p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run -dti --name=elasticsearch --network=host -v /home/ubuntu/Desktop/elasticsearch<span class="number">-2.4</span><span class="number">.6</span>/config:/us</span><br></pre></td></tr></table></figure>

<p><img src="https://qny.jkraise.top/Django-knowledge/1622039303627.png" alt="1622039303627"></p>
</li>
<li><h3 id="Haystack介绍和安装配置"><a href="#Haystack介绍和安装配置" class="headerlink" title="Haystack介绍和安装配置"></a>Haystack介绍和安装配置</h3><blockquote>
<p><strong>1.Haystack介绍</strong></p>
</blockquote>
<ul>
<li><p>Haystack </p>
<p>是在Django中对接搜索引擎的框架，搭建了用户和搜索引擎之间的沟通桥梁。</p>
<ul>
<li>我们在Django中可以通过使用 Haystack 来调用 Elasticsearch 搜索引擎。</li>
</ul>
</li>
<li><p>Haystack 可以在不修改代码的情况下使用不同的搜索后端（比如<code>Elasticsearch</code>、<code>Whoosh</code>、<code>Solr</code>等等）。</p>
</li>
</ul>
<blockquote>
<p><strong>2.Haystack安装</strong></p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ pip install django-haystack</span><br><span class="line">$ pip install elasticsearch==<span class="number">2.4</span><span class="number">.1</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>3.Haystack注册应用和路由</strong></p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">&#x27;haystack&#x27;</span>, <span class="comment"># 全文检索</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>4.在setting中配置Haystack</strong></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Haystack</span><br><span class="line">HAYSTACK_CONNECTIONS &#x3D; &#123;</span><br><span class="line">    &#39;default&#39;: &#123;</span><br><span class="line">        &#39;ENGINE&#39;: &#39;haystack.backends.elasticsearch_backend.ElasticsearchSearchEngine&#39;,</span><br><span class="line">        &#39;URL&#39;: &#39;http:&#x2F;&#x2F;192.168.17.132:9200&#x2F;&#39;, # Elasticsearch服务器ip地址，端口号固定为9200</span><br><span class="line">        &#39;INDEX_NAME&#39;: &#39;meiduo_mall&#39;, # Elasticsearch建立的索引库的名称</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 当添加、修改、删除数据时，自动生成索引</span><br><span class="line"># HAYSTACK_SIGNAL_PROCESSOR &#x3D; &#39;haystack.signals.RealtimeSignalProcessor&#39;</span><br></pre></td></tr></table></figure>




</li>
</ol>
<h4 id="页面静态化"><a href="#页面静态化" class="headerlink" title="页面静态化"></a>页面静态化</h4><ul>
<li>为了，提升响应速度，提高用户体验，将页面做成静态化，放到静态服务器上运行，</li>
<li>与用户相关的不能做静态化处理，用局部刷新来获取 用户信息，购物车信息，</li>
</ul>
<ol>
<li>首页index_html， 用crontab 来定时生成</li>
<li>静态商品详情页面</li>
</ol>
<h4 id="购物车"><a href="#购物车" class="headerlink" title="购物车"></a>购物车</h4><ul>
<li>购物车存储方法<ul>
<li>用户选择 2个<code>huaweip40</code>添加到购物车中，状态为勾选</li>
</ul>
</li>
<li>一条完整的购物车记录包括了<code>用户</code>,<code>商品</code>,<code>数量</code>，<code>勾选状态</code></li>
<li><strong>存储数据</strong> ：<code>user_id</code>，<code>sku_id</code>，<code>count</code>，<code>selected</code></li>
</ul>
<p><strong>存储 说明</strong></p>
<ol>
<li>购物车数据量小， 结构简单，但是更新频繁，所以我们选择内存型数据库Redis</li>
</ol>
<p><strong>这里，允许用户不登录，也能添加到购物车，利用浏览器的cookie 存储</strong></p>
<ol>
<li><p>密文存储  </p>
<ul>
<li>解决方案：<code>pickle模块</code>和<code>base64模块</code></li>
</ul>
<p>pickle模块使用：</p>
<ul>
<li><code>pickle.dumps()</code>将Python数据序列化为bytes类型数据。</li>
<li><code>pickle.loads()</code>将bytes类型数据反序列化为python数据。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import pickle</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; dict &#x3D; &#123;&#39;1&#39;: &#123;&#39;count&#39;: 10, &#39;selected&#39;: True&#125;, &#39;2&#39;: &#123;&#39;count&#39;: 20, &#39;selected&#39;: False&#125;&#125;</span><br><span class="line">&gt;&gt;&gt; ret &#x3D; pickle.dumps(dict)</span><br><span class="line">&gt;&gt;&gt; ret</span><br><span class="line">b&#39;\x80\x03&#125;q\x00(X\x01\x00\x00\x001q\x01&#125;q\x02(X\x05\x00\x00\x00countq\x03K\nX\x08\x00\x00\x00selectedq\x04\x88uX\x01\x00\x00\x002q\x05&#125;q\x06(h\x03K\x14h\x04\x89uu.&#39;</span><br><span class="line">&gt;&gt;&gt; pickle.loads(ret)</span><br><span class="line">&#123;&#39;1&#39;: &#123;&#39;count&#39;: 10, &#39;selected&#39;: True&#125;, &#39;2&#39;: &#123;&#39;count&#39;: 20, &#39;selected&#39;: False&#125;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>base64模块是Python的标准模块，可以对bytes类型数据进行编码，并得到bytes类型的密文数据。</li>
<li>base64模块使用：<ul>
<li><code>base64.b64encode()</code>将bytes类型数据进行base64编码，返回编码后的bytes类型数据。</li>
<li><code>base64.b64deocde()</code>将base64编码后的bytes类型数据进行解码，返回解码后的bytes类型数据。</li>
</ul>
</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> base64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ret</span><br><span class="line"><span class="string">b&#x27;\x80\x03&#125;q\x00(X\x01\x00\x00\x001q\x01&#125;q\x02(X\x05\x00\x00\x00countq\x03K\nX\x08\x00\x00\x00selectedq\x04\x88uX\x01\x00\x00\x002q\x05&#125;q\x06(h\x03K\x14h\x04\x89uu.&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = base64.b64encode(ret)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b</span><br><span class="line"><span class="string">b&#x27;gAN9cQAoWAEAAAAxcQF9cQIoWAUAAABjb3VudHEDSwpYCAAAAHNlbGVjdGVkcQSIdVgBAAAAMnEFfXEGKGgDSxRoBIl1dS4=&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>base64.b64decode(b)</span><br><span class="line"><span class="string">b&#x27;\x80\x03&#125;q\x00(X\x01\x00\x00\x001q\x01&#125;q\x02(X\x05\x00\x00\x00countq\x03K\nX\x08\x00\x00\x00selectedq\x04\x88uX\x01\x00\x00\x002q\x05&#125;q\x06(h\x03K\x14h\x04\x89uu.&#x27;</span></span><br></pre></td></tr></table></figure>



</li>
</ol>
<h4 id="ubuntu-网卡，有时缺少-ens33"><a href="#ubuntu-网卡，有时缺少-ens33" class="headerlink" title="ubuntu 网卡，有时缺少 ens33"></a>ubuntu 网卡，有时缺少 ens33</h4><p><strong>解决方法</strong>  </p>
<p> 让他自动寻址，分别输入，就可以ping通了： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xx@ubuntu:~&#x2F;Desktop$ sudo ifconfig ens33 up</span><br><span class="line">xx@ubuntu:~&#x2F;Desktop$ sudo dhclient ens33</span><br><span class="line">xx@ubuntu:~&#x2F;Desktop$ sudo ifconfig ens33</span><br></pre></td></tr></table></figure>

<p>参考 <a target="_blank" rel="noopener" href="https://blog.csdn.net/DrunkMozart/article/details/106172583">Ubuntu18.04解决网卡失效的问题</a></p>
<h4 id="解决-Win10-与-Ubuntu16-04-之间实现粘贴复制"><a href="#解决-Win10-与-Ubuntu16-04-之间实现粘贴复制" class="headerlink" title="解决 Win10 与 Ubuntu16.04 之间实现粘贴复制"></a>解决 Win10 与 Ubuntu16.04 之间实现粘贴复制</h4><p> <strong>Ctrl+C,Ctrl+Shift+V</strong> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install open-vm-tools</span><br><span class="line">sudo apt install open-vm-tools-desktop</span><br><span class="line"># 重启</span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>

<h5 id="ubuntu安装-网络相关的包-apt-install-netscript"><a href="#ubuntu安装-网络相关的包-apt-install-netscript" class="headerlink" title="ubuntu安装 网络相关的包 apt install netscript"></a>ubuntu安装 网络相关的包 <code>apt install netscript</code></h5><h4 id="非幂等-amp-幂等"><a href="#非幂等-amp-幂等" class="headerlink" title="非幂等&amp;幂等"></a>非幂等&amp;幂等</h4><ol>
<li><p>概念</p>
<ol>
<li>非幂等<ol>
<li>如果后端处理理结果对于这些请求的最终结果不不同，跟<code>请求次数相关</code>，则称接⼝口⾮非幂等 </li>
</ol>
</li>
<li>幂等<ol>
<li>对于同⼀一个接⼝口，进⾏行行多次相同的请求，如果后端处理理结果对于这些请求都是相同的，则称接⼝口是幂等的 </li>
</ol>
</li>
</ol>
</li>
<li><p>场景</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PUT&#x2F;cart&#x2F;</span><br><span class="line">count 商品数量 原始值 10</span><br><span class="line"></span><br><span class="line">方式1 count 表示 商品数量 +1  --&gt;后端执行加1操作，&#x3D;&#x3D;&#x3D;&gt;非幂等</span><br><span class="line">PUT &#x2F;cart&#x2F; count&#x3D;1 --&gt; 11</span><br><span class="line">PUT &#x2F;cart&#x2F; count&#x3D;1 --&gt; 12</span><br><span class="line">PUT &#x2F;cart&#x2F; count&#x3D;1 --&gt; 13</span><br><span class="line"></span><br><span class="line">方式1 count 表示 修改之后的结果  --&gt;后端执行覆盖原有值，&#x3D;&#x3D;&#x3D;&gt;幂等</span><br><span class="line">PUT &#x2F;cart&#x2F; count&#x3D;1 --&gt; 1</span><br><span class="line">PUT &#x2F;cart&#x2F; count&#x3D;1 --&gt; 1</span><br><span class="line">PUT &#x2F;cart&#x2F; count&#x3D;13 --&gt; 13</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="Django-事务的使用"><a href="#Django-事务的使用" class="headerlink" title="Django 事务的使用"></a>Django 事务的使用</h4><blockquote>
<p><strong>1.Django中事务的使用方案</strong></p>
</blockquote>
<ul>
<li>在Django中可以通过<code>django.db.transaction模块</code>提供的<code>atomic</code>来定义一个事务。</li>
</ul>
<p><code>atomic</code>提供两种方案实现事务：</p>
<p>装饰器用法：</p>
<ul>
<li><pre><code class="py">from django.db import transaction

@transaction.atomic
def viewfunc(request):
  # 这些代码会在一个事务中执行
  ......
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">with语句用法：</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;py</span><br><span class="line">from django.db import transaction</span><br><span class="line"></span><br><span class="line">def viewfunc(request):</span><br><span class="line">  # 这部分代码不在事务中，会被Django自动提交</span><br><span class="line">  ......</span><br><span class="line"></span><br><span class="line">  with transaction.atomic():</span><br><span class="line">      # 这部分代码会在事务中执行</span><br><span class="line">      ......</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<blockquote>
<p><strong>2.事务方案的选择：</strong></p>
</blockquote>
<ul>
<li><strong>装饰器用法：</strong> 整个视图中所有MySQL数据库的操作都看做一个事务，范围太大，不够灵活。而且无法直接作用于类视图。</li>
<li><strong>with语句用法：</strong> 可以灵活的有选择性的把某些MySQL数据库的操作看做一个事务。而且不用关心视图的类型。</li>
<li>具体情况具体分析</li>
</ul>
<blockquote>
<p><strong>3.事务中的保存点：</strong></p>
</blockquote>
<ul>
<li>在Django中，还提供了保存点的支持，可以在事务中创建保存点来记录数据的特定状态，数据库出现错误时，可以回滚到数据保存点的状态。</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建保存点</span></span><br><span class="line">save_id = transaction.savepoint()  </span><br><span class="line"><span class="comment"># 回滚到保存点</span></span><br><span class="line">transaction.savepoint_rollback(save_id)</span><br><span class="line"><span class="comment"># 提交从保存点到当前状态的所有数据库事务操作</span></span><br><span class="line">transaction.savepoint_commit(save_id)</span><br></pre></td></tr></table></figure>

<h4 id="使用乐观锁并发下单"><a href="#使用乐观锁并发下单" class="headerlink" title="使用乐观锁并发下单"></a>使用乐观锁并发下单</h4><blockquote>
<p>原因</p>
</blockquote>
<ul>
<li>在多个用户同时发起对同一个商品的下单请求时，先查询商品库存，再修改商品库存，会出现资源竞争问题，导致库存的最终结果出现异常。</li>
</ul>
<p><strong>注意</strong> 使用乐观锁的时候，如果一个事务修改了库存并提交了事务，那其他的事务应该可以读取到修改后的数据值，所以不能使用可重复读的隔离级别，应该修改为读取已提交（Read committed）</p>
<h4 id="MySQL事务隔离级别"><a href="#MySQL事务隔离级别" class="headerlink" title="MySQL事务隔离级别"></a>MySQL事务隔离级别</h4><ul>
<li>事务隔离级别指的是在处理同一个数据的多个事务中，一个事务修改数据后，其他事务何时能看到修改后的结果。</li>
<li>MySQL数据库事务隔离级别主要有四种：<ul>
<li><code>Serializable</code>：串行化，一个事务一个事务的执行。</li>
<li><code>Repeatable read</code>：可重复读，无论其他事务是否修改并提交了数据，在这个事务中看到的数据值始终不受其他事务影响。</li>
<li><code>Read committed</code>：读取已提交，其他事务提交了对数据的修改后，本事务就能读取到修改后的数据值。</li>
<li><code>Read uncommitted</code>：读取未提交，其他事务只要修改了数据，即使未提交，本事务也能看到修改后的数据值。</li>
<li>MySQL数据库默认使用可重复读（ Repeatable read）。</li>
</ul>
</li>
<li>使用乐观锁的时候，如果一个事务修改了库存并提交了事务，那其他的事务应该可以读取到修改后的数据值，所以不能使用可重复读的隔离级别，应该修改为读取已提交（Read committed）。</li>
<li>修改方式：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo vim &#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf</span><br><span class="line"></span><br><span class="line">修改完成之后重启</span><br><span class="line">sudo service mysql restart</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transaction-isolation&#x3D;READ-COMMITTED</span><br></pre></td></tr></table></figure>

<h3 id="Django-接入-支付-支付宝为例"><a href="#Django-接入-支付-支付宝为例" class="headerlink" title="Django 接入 支付(支付宝为例)"></a>Django 接入 支付(支付宝为例)</h3><blockquote>
<p><strong>支付宝开放平台入口</strong></p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://open.alipay.com/platform/home.htm">https://open.alipay.com/platform/home.htm</a></li>
</ul>
<p><strong>登录 账号</strong></p>
<p><strong>控制台</strong></p>
<p>创建应用</p>
<p><img src="https://qny.jkraise.top/Django-knowledge/image-20210608220332914.png" alt="image-20210608220332914"></p>
<h5 id="开发服务-测试"><a href="#开发服务-测试" class="headerlink" title="开发服务-测试"></a>开发服务-测试</h5><p><strong>沙箱环境</strong></p>
<p><img src="https://qny.jkraise.top/Django-knowledge/image-20210608220404402.png" alt="image-20210608220404402"></p>
<blockquote>
<p><strong>沙箱环境</strong></p>
<p><strong>支付宝提供给开发者的模拟支付的环境。跟真实环境是分开的。</strong></p>
</blockquote>
<ul>
<li>沙箱应用：<a target="_blank" rel="noopener" href="https://openhome.alipay.com/platform/appDaily.htm?tab=info">https://openhome.alipay.com/platform/appDaily.htm?tab=info</a></li>
</ul>
<p><img src="https://qny.jkraise.top/Django-knowledge/1623247171683.png" alt="1623247171683"></p>
<p><img src="https://qny.jkraise.top/Django-knowledge/1623247333771.png" alt="1623247333771"></p>
<h5 id="支付宝开发文档"><a href="#支付宝开发文档" class="headerlink" title="支付宝开发文档"></a>支付宝开发文档</h5><ul>
<li><p>文档主页： <a target="_blank" rel="noopener" href="https://openhome.alipay.com/developmentDocument.htm">https://openhome.alipay.com/developmentDocument.htm</a></p>
</li>
<li><p>电脑网站支付产品介绍： <a target="_blank" rel="noopener" href="https://docs.open.alipay.com/270">https://docs.open.alipay.com/270</a></p>
</li>
<li><p>电脑网站支付快速接入： <a target="_blank" rel="noopener" href="https://docs.open.alipay.com/270/105899/">https://docs.open.alipay.com/270/105899/</a></p>
</li>
<li><p>API列表： <a target="_blank" rel="noopener" href="https://docs.open.alipay.com/270/105900/">https://docs.open.alipay.com/270/105900/</a></p>
</li>
<li><p>SDK文档： <a target="_blank" rel="noopener" href="https://docs.open.alipay.com/270/106291/">https://docs.open.alipay.com/270/106291/</a></p>
</li>
<li><p>Python支付宝SDK： 这里使用第三方编写，调用简洁</p>
</li>
</ul>
<p>  <a target="_blank" rel="noopener" href="https://github.com/fzlee/alipay/blob/master/README.zh-hans.md">https://github.com/fzlee/alipay/blob/master/README.zh-hans.md</a></p>
<ul>
<li>SDK安装： <code>pip install python-alipay-sdk --upgrade</code></li>
</ul>
<h3 id="配置RSA2公私钥"><a href="#配置RSA2公私钥" class="headerlink" title="配置RSA2公私钥"></a>配置RSA2公私钥</h3><p><strong>生成项目公钥</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ openssl</span><br><span class="line">$ OpenSSL&gt; genrsa -out app_private_key.pem 2048  # 制作私钥RSA2</span><br><span class="line">$ OpenSSL&gt; rsa -in app_private_key.pem -pubout -out app_public_key.pem # 导出公钥</span><br><span class="line"></span><br><span class="line">$ OpenSSL&gt; exit</span><br></pre></td></tr></table></figure>



<h5 id="调用时注意"><a href="#调用时注意" class="headerlink" title="调用时注意"></a>调用时注意</h5><p><code>notify_url=&quot; &quot;,</code> 此参数一定要写，<code>Str类型</code></p>
<pre><code>   # 生成登录支付宝连接
   order_string = alipay.api_alipay_trade_page_pay(
        out_trade_no=order_id,
        total_amount=str(order.total_amount),
        subject=&quot;美多商城%s&quot; % order_id,
        return_url=settings.ALIPAY_RETURN_URL,
        notify_url=&quot; &quot;,</code></pre>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">app_private_key_string &#x3D; open(settings.APP_PRIVATE_KEY_PATH).read()</span><br><span class="line">        alipay_public_key_string &#x3D; open(settings.ALIPAY_PUBLIC_KEY_PATH).read()</span><br><span class="line">        # 创建支付宝对象</span><br><span class="line">        alipay &#x3D; AliPay(</span><br><span class="line">            appid&#x3D;settings.ALIPAY_APPID,</span><br><span class="line">            app_notify_url&#x3D;None,  # 默认回调url</span><br><span class="line">            app_private_key_string&#x3D;app_private_key_string,</span><br><span class="line">            # 支付宝的公钥，验证支付宝回传消息使用，不是你自己的公钥，</span><br><span class="line">            alipay_public_key_string&#x3D;alipay_public_key_string,</span><br><span class="line">            sign_type&#x3D;&#39;RSA2&#39;,</span><br><span class="line">            debug&#x3D;True</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        print(&quot;打印参数》》》》》&quot;)</span><br><span class="line"></span><br><span class="line">        print(type(settings.ALIPAY_RETURN_URL))</span><br><span class="line">        print(&quot;执行》》》》》》》&quot;)</span><br><span class="line">        # 生成登录支付宝连接</span><br><span class="line">        order_string &#x3D; alipay.api_alipay_trade_page_pay(</span><br><span class="line">            out_trade_no&#x3D;order_id,</span><br><span class="line">            total_amount&#x3D;str(order.total_amount),</span><br><span class="line">            subject&#x3D;&quot;美多商城%s&quot; % order_id,</span><br><span class="line">            return_url&#x3D;settings.ALIPAY_RETURN_URL,</span><br><span class="line">            notify_url&#x3D;&quot; &quot;,</span><br><span class="line">        )</span><br><span class="line">		</span><br><span class="line">		# 生成登录支付宝连接</span><br><span class="line">        # 3.0 接口方法</span><br><span class="line">        order_string &#x3D; alipay.client_api(</span><br><span class="line">            &quot;alipay.trade.page.pay&quot;,</span><br><span class="line">            biz_content&#x3D;&#123;</span><br><span class="line">                &quot;subject&quot;: &quot;美多商城%s&quot; % order_id,</span><br><span class="line">                &quot;out_trade_no&quot;: order_id,</span><br><span class="line">                &quot;total_amount&quot;: str(order.total_amount),</span><br><span class="line">                &quot;product_code&quot;: &quot;FAST_INSTANT_TRADE_PAY&quot;,</span><br><span class="line">            &#125;,</span><br><span class="line">            return_url&#x3D;settings.ALIPAY_RETURN_URL,</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        # 响应登录支付宝连接</span><br><span class="line">        # 真实环境电脑网站支付网关：https:&#x2F;&#x2F;openapi.alipay.com&#x2F;gateway.do? + order_string</span><br><span class="line">        # 沙箱环境电脑网站支付网关：https:&#x2F;&#x2F;openapi.alipaydev.com&#x2F;gateway.do? + order_string</span><br><span class="line">        alipay_url &#x3D; settings.ALIPAY_URL + &quot;?&quot; + order_string</span><br><span class="line">        # print(&quot;alipay_url&quot;)</span><br><span class="line">        # print(alipay_url)</span><br><span class="line">        return JsonResponse(&#123;&#39;code&#39;: 0, &#39;errmsg&#39;: &#39;OK&#39;, &#39;alipay_url&#39;: alipay_url&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="后台部署"><a href="#后台部署" class="headerlink" title="后台部署"></a>后台部署</h3><h4 id="弃用Django自带的admin，使用扩展-xadmin"><a href="#弃用Django自带的admin，使用扩展-xadmin" class="headerlink" title="弃用Django自带的admin，使用扩展 xadmin"></a>弃用Django自带的admin，使用扩展 xadmin</h4><h5 id="安装-ubuntu18-04-pip-install-https-github-com-sshwsfc-xadmin-tarball"><a href="#安装-ubuntu18-04-pip-install-https-github-com-sshwsfc-xadmin-tarball" class="headerlink" title="安装  ubuntu18.04  pip install https://github.com/sshwsfc/xadmin/tarball/ "></a>安装  ubuntu18.04  <code>pip install https://github.com/sshwsfc/xadmin/tarball/ </code></h5><p>​        win10  解决  <a target="_blank" rel="noopener" href="https://blog.csdn.net/teavamc/article/details/75400755">https://blog.csdn.net/teavamc/article/details/75400755</a></p>
<h5 id="注册应用"><a href="#注册应用" class="headerlink" title="注册应用"></a>注册应用</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># xadmin  配置</span><br><span class="line">    &#39;xadmin&#39;,</span><br><span class="line">    &#39;crispy_forms&#39;,</span><br><span class="line">    &#39;reversion&#39;,</span><br></pre></td></tr></table></figure>

<h5 id="迁移Xadmin数据库"><a href="#迁移Xadmin数据库" class="headerlink" title="迁移Xadmin数据库"></a>迁移Xadmin数据库</h5><p> python manage.py makemigrations </p>
<h4 id="mysql-数据库主从"><a href="#mysql-数据库主从" class="headerlink" title="mysql 数据库主从"></a>mysql 数据库主从</h4><p><strong>作用</strong></p>
<ul>
<li><p>通过增加从服务器来提⾼数据库的性能，在主服务器上执⾏写⼊和更新，在从服务器器上向外提供读功能，可以动态地调整从服务器器的数量，从⽽调整整个数据库的性能。</p>
</li>
<li><p>提⾼数据安全，因为数据已复制到从服务器，从服务器可以终止复制进程，所以，可以在从服务器上备份⽽不破坏主服务器相应数据</p>
</li>
<li><p>在主服务器上生成实时数据，而在从服务器器上分析这些数据，从而提高主服务器的性能 </p>
</li>
</ul>
<h5 id="热备份-主机不停机，实时将数据备份给从机"><a href="#热备份-主机不停机，实时将数据备份给从机" class="headerlink" title="热备份 主机不停机，实时将数据备份给从机"></a>热备份 主机不停机，实时将数据备份给从机</h5><h5 id="冷备份-主机需要停机，再将数据备份给从机"><a href="#冷备份-主机需要停机，再将数据备份给从机" class="headerlink" title="冷备份   主机需要停机，再将数据备份给从机"></a>冷备份   主机需要停机，再将数据备份给从机</h5><p><strong>同步机制</strong></p>
<p>1.先执行冷备份</p>
<p>2.再执行热备份</p>
<p><img src="https://qny.jkraise.top/Django-knowledge/1623760067968.png" alt="1623760067968"></p>
<p><strong>注意： mysql 主从机的版本，不要相差太大</strong></p>
<ol>
<li><p><strong>修改从机配置文件</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 修改端口</span><br><span class="line">port &#x3D; 8306</span><br><span class="line"></span><br><span class="line">#  是否生成日志文件   0 不生成  1生成</span><br><span class="line">general_log_file   &#x3D;  &#x2F;var&#x2F;log&#x2F;mysql&#x2F;mysql.log</span><br><span class="line">general_log        &#x3D;  0   </span><br><span class="line"></span><br><span class="line"># 主机 为1</span><br><span class="line"># 修改从机</span><br><span class="line">server-id    &#x3D; 2</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>主机配置</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server-id &#x3D; 1</span><br><span class="line"># log日志文件</span><br><span class="line">log_bin   &#x3D; &#x2F;var&#x2F;log&#x2F;mysql&#x2F;mysql-bin.log</span><br></pre></td></tr></table></figure>

<p><strong>重启主机的mysql</strong></p>
</li>
<li><p><img src="https://qny.jkraise.top/Django-knowledge/1623849155977.png" alt="1623849155977"></p>
</li>
<li><p>创建从机账号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql –uroot –pmysql</span><br><span class="line">GRANT REPLICATION SLAVE ON *.* TO &#39;slave&#39;@&#39;%&#39; identified by &#39;slave&#39;;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取mysql主机的二进制日志信息</p>
<p> 在主机上 <code>SHOW MASTER STATUS;</code></p>
<p> <img src="https://qny.jkraise.top/Django-knowledge/1623849799894.png" alt="1623849799894"></p>
<p><strong>说明</strong></p>
<p>file  &gt;&gt;   从机热备份时读取数据的文件</p>
<p>Position   &gt;&gt;   从机热备份时读取数据的位置，节点</p>
<p><img src="https://qny.jkraise.top/Django-knowledge/1623854721035.png" alt="1623854721035"></p>
<p>在从机上 <code>SHOW MASTER STATUS;</code></p>
<p><img src="https://qny.jkraise.top/Django-knowledge/1623854396821.png" alt="1623854396821"></p>
</li>
</ol>
<h2 id="序列化器"><a href="#序列化器" class="headerlink" title="序列化器"></a>序列化器</h2><h5 id="1-安装"><a href="#1-安装" class="headerlink" title="1.  安装"></a>1.  安装</h5><ol>
<li><pre><code>pip install djangorestframework
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">##### 2. 注册序列化器</span><br><span class="line"></span><br><span class="line">   1. &#96;&#96;&#96;</span><br><span class="line">      INSTALLED_APPS &#x3D; [</span><br><span class="line">          ...</span><br><span class="line">          &#39;rest_framework&#39;,</span><br><span class="line">      ]</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ol>
<h5 id="3-创建序列化器"><a href="#3-创建序列化器" class="headerlink" title="3. 创建序列化器"></a>3. 创建序列化器</h5><ol>
<li><p>模型类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">from django.db import models</span><br><span class="line"></span><br><span class="line"># Create your models here.</span><br><span class="line"># 准备书籍列表信息的模型类</span><br><span class="line">class BookInfo(models.Model):</span><br><span class="line">    # 创建字段，字段类型...</span><br><span class="line">    name &#x3D; models.CharField(max_length&#x3D;20, verbose_name&#x3D;&#39;名称&#39;)</span><br><span class="line">    pub_date &#x3D; models.DateField(verbose_name&#x3D;&#39;发布日期&#39;,null&#x3D;True)</span><br><span class="line">    breadcount &#x3D; models.IntegerField(default&#x3D;0, verbose_name&#x3D;&#39;阅读量&#39;)</span><br><span class="line">    bcommentcount &#x3D; models.IntegerField(default&#x3D;0, verbose_name&#x3D;&#39;评论量&#39;)</span><br><span class="line">    is_delete &#x3D; models.BooleanField(default&#x3D;False, verbose_name&#x3D;&#39;逻辑删除&#39;)</span><br><span class="line">    image &#x3D; models.ImageField(upload_to&#x3D;&#39;book&#39;, null&#x3D;True, verbose_name&#x3D;&#39;图片&#39;)</span><br><span class="line"></span><br><span class="line">    class Meta:</span><br><span class="line">        db_table &#x3D; &#39;bookinfo&#39;  # 指明数据库表名</span><br><span class="line">        verbose_name &#x3D; &#39;图书&#39;  # 在admin站点中显示的名称</span><br><span class="line"></span><br><span class="line">    def __str__(self):</span><br><span class="line">        &quot;&quot;&quot;定义每个数据对象的显示信息&quot;&quot;&quot;</span><br><span class="line">        return self.name</span><br><span class="line"></span><br><span class="line"># 准备人物列表信息的模型类</span><br><span class="line">class HeroInfo(models.Model):</span><br><span class="line"></span><br><span class="line">    hname &#x3D; models.CharField(max_length&#x3D;20, verbose_name&#x3D;&#39;名称&#39;)</span><br><span class="line">    hgender &#x3D; models.IntegerField(max_length&#x3D;20,verbose_name&#x3D;&#39;密码&#39;)</span><br><span class="line">    hdesc &#x3D; models.CharField(max_length&#x3D;200, null&#x3D;True, verbose_name&#x3D;&#39;描述信息&#39;)</span><br><span class="line">    hbook &#x3D; models.ForeignKey(BookInfo,related_name&#x3D;&#39;people&#39;, on_delete&#x3D;models.CASCADE, verbose_name&#x3D;&#39;图书&#39;)  # 外键</span><br><span class="line">    is_delete &#x3D; models.BooleanField(default&#x3D;False, verbose_name&#x3D;&#39;逻辑删除&#39;)</span><br><span class="line"></span><br><span class="line">    class Meta:</span><br><span class="line">        db_table &#x3D; &#39;heroinfo&#39;</span><br><span class="line">        verbose_name &#x3D; &#39;人物信息&#39;</span><br><span class="line"></span><br><span class="line">    def __str__(self):</span><br><span class="line">        return self.hname</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建<code>serializers.py</code>文件</p>
<ol>
<li>写序列化器</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">from rest_framework import serializers</span><br><span class="line"></span><br><span class="line">from book.models import BookInfo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class PeopleInfoSerializer(serializers.Serializer):</span><br><span class="line">    &quot;&quot;&quot;英雄数据序列化器&quot;&quot;&quot;</span><br><span class="line">    id &#x3D; serializers.IntegerField(label&#x3D;&#39;ID&#39;)</span><br><span class="line">    hname &#x3D; serializers.CharField(label&#x3D;&#39;名字&#39;)</span><br><span class="line">    hgender &#x3D; serializers.IntegerField(label&#x3D;&quot;性别&quot;)</span><br><span class="line">    hdesc &#x3D; serializers.CharField(label&#x3D;&quot;描述信息&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;定义序列化器&quot;&quot;&quot;</span><br><span class="line">class BookInfoSerializer(serializers.Serializer):</span><br><span class="line">    &quot;&quot;&quot;图书数据序列化器&quot;&quot;&quot;</span><br><span class="line">    id &#x3D; serializers.IntegerField(label&#x3D;&#39;ID&#39;)</span><br><span class="line">    name &#x3D; serializers.CharField(label&#x3D;&#39;名称&#39;)</span><br><span class="line">    pub_date &#x3D; serializers.DateField(label&#x3D;&#39;发布日期&#39;)</span><br><span class="line">    breadcount &#x3D; serializers.IntegerField(label&#x3D;&#39;阅读量&#39;)</span><br><span class="line">    bcommentcount &#x3D; serializers.IntegerField(label&#x3D;&#39;评论量&#39;)</span><br><span class="line">    #  一对多的序列化器</span><br><span class="line">    people &#x3D; PeopleInfoSerializer(many&#x3D;True)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class PeopleSerializer(serializers.Serializer):</span><br><span class="line">    &quot;&quot;&quot;英雄数据序列化器&quot;&quot;&quot;</span><br><span class="line">    id &#x3D; serializers.IntegerField(label&#x3D;&#39;ID&#39;)</span><br><span class="line">    hname &#x3D; serializers.CharField(label&#x3D;&#39;名字&#39;)</span><br><span class="line">    hgender &#x3D; serializers.IntegerField(label&#x3D;&quot;性别&quot;)</span><br><span class="line">    hdesc &#x3D; serializers.CharField(label&#x3D;&quot;描述信息&quot;)</span><br><span class="line"></span><br><span class="line">    # hbook_id &#x3D; serializers.IntegerField(label&#x3D;&quot;图书id&quot;)</span><br><span class="line">    # hbook &#x3D; serializers.PrimaryKeyRelatedField(label&#x3D;&#39;图书&#39;,read_only&#x3D;True)   # 不能被反序列化</span><br><span class="line">    # hbook &#x3D; serializers.PrimaryKeyRelatedField(label&#x3D;&#39;图书&#39;,queryset&#x3D;BookInfo.objects.all())</span><br><span class="line">    # # 此字段将被序列化为关联对象的字符串表示方式（即__str__方法的返回值）</span><br><span class="line">    # hbook &#x3D; serializers.StringRelatedField(label&#x3D;&quot;图书&quot;)</span><br><span class="line">    # # 图书的序列化信息</span><br><span class="line">    hbook &#x3D; BookInfoSerializer()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>序列化输出</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from book.models import BookInfo,HeroInfo</span><br><span class="line">hero &#x3D; HeroInfo.objects.get(id&#x3D;3)</span><br><span class="line">from book.serializers import PeopleSerializer</span><br><span class="line">hero_ser &#x3D; PeopleSerializer(hero)</span><br><span class="line">hero_ser.data</span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="4">
<li><p>反序列化器</p>
<ol>
<li><p>写一个 字典</p>
</li>
<li><p>创建 序列化器对象 serializer </p>
</li>
<li><p>验证</p>
</li>
<li><p>保存</p>
<p><strong>代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> book.models <span class="keyword">import</span> BookInfo,HeroInfo</span><br><span class="line"><span class="keyword">from</span> book.serializers <span class="keyword">import</span> PeopleSerializer, BookInfoSerializer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">     <span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;Python高级&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;pub_date&#x27;</span>:<span class="string">&#x27;2020-1-1&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;breadcount&#x27;</span>:<span class="number">100</span>,</span><br><span class="line">     <span class="string">&#x27;bcommentcount&#x27;</span>:<span class="number">200</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建序列化对象</span></span><br><span class="line">book = BookInfoSerializer(data=data)</span><br><span class="line">   </span><br><span class="line"><span class="comment"># 验证 返回 True False</span></span><br><span class="line">book.is_valid()   </span><br><span class="line">   </span><br><span class="line"><span class="comment"># 查看报错信息</span></span><br><span class="line">book.errors</span><br><span class="line"><span class="comment"># 返回 &#123;&#125;  </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> <code>is_valid()</code> 方法还可以在验证失败时抛出异常serializers.ValidationError，可以通过传递<strong>raise_exception=True</strong>参数开启，REST framework接收到此异常，会向前端返回HTTP 400 Bad Request响应。  </p>
</li>
</ol>
</li>
</ol>
<p><img src="https://qny.jkraise.top/Django-knowledge/1623897517610.png" alt="1623897517610"></p>
<p>   <strong>read__only和write__only 不能同时出现</strong></p>
<p>   **验证字段方法validate_filedname **    </p>
<p>   可以  进行正则判断，</p>
<p>   <img src="https://qny.jkraise.top/Django-knowledge/1623898018991.png" alt="1623898018991"></p>
<p>   <strong>validate</strong></p>
<p>   在序列化器中需要同时对多个字段进行比较验证时，可以定义validate方法来验证，如</p>
   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">validate</span>(<span class="params">self, attrs</span>):</span></span><br><span class="line">       readcount = attrs[<span class="string">&#x27;readcount&#x27;</span>]</span><br><span class="line">       commentcount = attrs[<span class="string">&#x27;commentcount&#x27;</span>]</span><br><span class="line">       <span class="keyword">if</span> commentcount &gt; readcount:</span><br><span class="line">           <span class="keyword">raise</span> serializers.ValidationError(<span class="string">&#x27;评论量不能大于阅读量&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> attrs</span><br></pre></td></tr></table></figure>

<p>   <strong>保存</strong></p>
<p>保存到数据库，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 序列化器类，定义create 方法</span><br><span class="line">def create(self, validated_data):</span><br><span class="line">        &quot;&quot;&quot;新建&quot;&quot;&quot;</span><br><span class="line">        return BookInfo.objects.create(**validated_data)</span><br></pre></td></tr></table></figure>

<p>代码</p>
<p>**注意： 如果创建序列化器对象的时候，没有传递instance实例，则调用save()方法的时候，create()被调用。 **</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from book.serializers import BookInfoSerializer</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt; data &#x3D; &#123;</span><br><span class="line">...     &#39;name&#39;:&#39;Python高级&#39;,</span><br><span class="line">...     &#39;pub_date&#39;:&#39;2020-01-01&#39;,</span><br><span class="line">...     &#39;readcount&#39;:100,</span><br><span class="line">...     &#39;commentcount&#39;:20</span><br><span class="line">... &#125;</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt; serializer &#x3D; BookInfoSerializer(data&#x3D;data)</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt; serializer.is_valid(raise_exception&#x3D;True)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt; serializer.save()</span><br><span class="line">&lt;BookInfo: Python高级&gt;</span><br></pre></td></tr></table></figure>

<p><strong>更新</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def update(self, instance, validated_data):</span><br><span class="line">        &quot;&quot;&quot;更新，instance为要更新的对象实例&quot;&quot;&quot;</span><br><span class="line">        instance.name &#x3D; validated_data.get(&#39;name&#39;, instance.name)</span><br><span class="line">        instance.pub_date &#x3D; validated_data.get(&#39;pub_date&#39;, instance.pub_date)</span><br><span class="line">        instance.readcount &#x3D; validated_data.get(&#39;readcount&#39;, instance.readcount)</span><br><span class="line">        instance.commentcount &#x3D; validated_data.get(&#39;commentcount&#39;, instance.commentcount)</span><br><span class="line">        instance.save()</span><br><span class="line">        return instance</span><br></pre></td></tr></table></figure>

<pre><code>  **注意： 如果创建序列化器对象的时候，如果传递了instance实例，则调用save()方法的时候，update()被调用。**</code></pre>
<p><strong>测试</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from book.serializers import BookInfoSerializer</span><br><span class="line">&gt;&gt;&gt; from book.models import BookInfo</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt; book &#x3D; BookInfo.objects.get(id&#x3D;5)</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt; data &#x3D; &#123;</span><br><span class="line">...     &#39;name&#39;:&#39;Django高级&#39;,</span><br><span class="line">...     &#39;pub_date&#39;:&#39;2020-01-01&#39;,</span><br><span class="line">...     &#39;readcount&#39;:100,</span><br><span class="line">...     &#39;commentcount&#39;:20</span><br><span class="line">... &#125;</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt; serializer &#x3D; BookInfoSerializer(instance&#x3D;book,data&#x3D;data)</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt; serializer.is_valid(raise_exception&#x3D;True)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt; serializer.save()</span><br><span class="line">&lt;BookInfo: Django高级&gt;</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p><strong>小结</strong></p>
<ul>
<li>如果没有传入<code>instance</code> 则 是保存 到数据库，自动调用 <code>create方法</code></li>
<li>传入<code>instance</code> 则 是更新 到数据库，自动调用 <code>update方法</code></li>
</ul>
<h4 id="两点说明："><a href="#两点说明：" class="headerlink" title="两点说明："></a>两点说明：</h4><p>1） 在对序列化器进行save()保存时，可以额外传递数据，这些数据可以在create()和update()中的validated_data参数获取到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serializer.save(user&#x3D;request.user)</span><br></pre></td></tr></table></figure>

<p>2）默认序列化器必须传递所有required的字段，否则会抛出验证异常。但是我们可以使用partial参数来允许部分字段更新</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serializer &#x3D; BookInfoSerializer(instance&#x3D;book, data&#x3D;&#123;&#39;pub_date&#39;: &#39;2999-1-1&#39;&#125;, partial&#x3D;True)</span><br></pre></td></tr></table></figure>

<h4 id="模型类序列化器ModelSerializer"><a href="#模型类序列化器ModelSerializer" class="headerlink" title="模型类序列化器ModelSerializer"></a>模型类序列化器ModelSerializer</h4><h5 id="ModelSerializer与常规的Serializer相同，但提供了："><a href="#ModelSerializer与常规的Serializer相同，但提供了：" class="headerlink" title="ModelSerializer与常规的Serializer相同，但提供了："></a>ModelSerializer与常规的Serializer相同，但提供了：</h5><ul>
<li>基于模型类自动生成一系列字段</li>
<li>包含默认的create()和update()的实现</li>
</ul>
<h5 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from rest_framework import serializers</span><br><span class="line">from book.models import BookInfo</span><br><span class="line"></span><br><span class="line">class BookInfoModelSerializer(serializers.ModelSerializer):</span><br><span class="line"></span><br><span class="line">    class Meta:</span><br><span class="line">        model &#x3D; BookInfo   # 必须指定模型类</span><br><span class="line">        fields &#x3D; &#39;__all__&#39;	# 默认生成字段 </span><br><span class="line">        # 可以自己指定字段</span><br><span class="line">        # fields &#x3D; [&quot;id&quot;, &quot;name&quot;]</span><br><span class="line">        # 除去列表中的字段</span><br><span class="line">        # exclude &#x3D; [&quot;is_delete&quot;]</span><br></pre></td></tr></table></figure>

<h5 id="演示"><a href="#演示" class="headerlink" title="演示"></a>演示</h5><p><img src="https://qny.jkraise.top/Django-knowledge/1623999276975.png" alt="1623999276975"></p>
<ul>
<li><p>设置某些字段为只读</p>
<p><img src="https://qny.jkraise.top/Django-knowledge/1624000128281.png" alt="1624000128281"></p>
</li>
<li><p>额外参数</p>
<p><img src="https://qny.jkraise.top/Django-knowledge/1624000331193.png" alt="1624000331193"></p>
</li>
</ul>
<h5 id="序列化器关联的外键写法"><a href="#序列化器关联的外键写法" class="headerlink" title="序列化器关联的外键写法"></a>序列化器关联的外键写法</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">subs &#x3D; AreaSerializer(many&#x3D;True)  #  subs 是省下面的所有的市区县</span><br><span class="line"></span><br><span class="line"># subs &#x3D; serializers.PrimaryKeyRelatedField()  # 只会序列化出 id</span><br><span class="line"># subs &#x3D; serializers.StringRelatedField()  # 序列化的时模型中str方法返回值</span><br></pre></td></tr></table></figure>



<h4 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h4><ul>
<li><p>扩展 Request</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Django自带的  request.GET </span><br><span class="line"># 扩展          request.query_params</span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"># Django自带的  request.POST </span><br><span class="line"># 扩展          request.data</span><br></pre></td></tr></table></figure>
</li>
<li><p>扩展 Response</p>
<p> REST framework提供了<code>Renderer</code>渲染器，<strong>用来根据请求头中的</strong><code>Accept</code><strong>（接收数据类型声明）来自动转换响应数据到对应格式</strong>。如果前<strong>端请求中未进行Accept声明，则会采用默认方式处理响应数据</strong>，我们可以通过配置来修改默认响应格式。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK &#x3D; &#123;</span><br><span class="line">    &#39;DEFAULT_RENDERER_CLASSES&#39;: (  # 默认响应渲染类</span><br><span class="line">        &#39;rest_framework.renderers.JSONRenderer&#39;,  # json渲染器</span><br><span class="line">        &#39;rest_framework.renderers.BrowsableAPIRenderer&#39;,  # 浏览API渲染器</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>构造方式</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Response(data, status&#x3D;None, template_name&#x3D;None, headers&#x3D;None, content_type&#x3D;None)</span><br></pre></td></tr></table></figure>

<p>参数说明：</p>
<ul>
<li><code>data</code>: 为响应准备的序列化处理后的数据；</li>
<li><code>status</code>: 状态码，默认200；</li>
<li><code>template_name</code>: 模板名称，如果使用<code>HTMLRenderer</code>时需指明；</li>
<li><code>headers</code>: 用于存放响应头信息的字典；</li>
<li><code>content_type</code>: 响应数据的Content-Type，通常此参数无需传递，REST framework会根据前端所需类型数据来设置该参数。</li>
</ul>
</li>
</ul>
<h5 id="1-APIView-一级"><a href="#1-APIView-一级" class="headerlink" title="1. APIView(一级)"></a>1. APIView(一级)</h5><p><code>APIView</code>与<code>View</code>的不同之处在于：</p>
<ul>
<li>传入到视图方法中的是REST framework的<code>Request</code>对象，而不是Django的<code>HttpRequeset</code>对象；</li>
<li>视图方法可以返回REST framework的<code>Response</code>对象，视图会为响应数据设置（render）符合前端要求的格式；</li>
<li>任何<code>APIException</code>异常都会被捕获到，并且处理成合适的响应信息；</li>
<li>在进行dispatch()分发前，会对请求进行身份认证、权限检查、流量控制。</li>
</ul>
<h5 id="支持定义的属性："><a href="#支持定义的属性：" class="headerlink" title="支持定义的属性："></a>支持定义的属性：</h5><ul>
<li><strong>authentication_classes</strong>列表或元祖，身份认证类</li>
<li><strong>permissoin_classes</strong>列表或元祖，权限检查类</li>
<li><strong>throttle_classes</strong>列表或元祖，流量控制类</li>
</ul>
<p><img src="https://qny.jkraise.top/Django-knowledge/1624234856277.png" alt="1624234856277"></p>
<h5 id="2-GenericAPIView-二级"><a href="#2-GenericAPIView-二级" class="headerlink" title="2. GenericAPIView(二级)"></a>2. GenericAPIView(二级)</h5><h5 id="支持定义的属性：-1"><a href="#支持定义的属性：-1" class="headerlink" title="支持定义的属性："></a>支持定义的属性：</h5><ul>
<li><h3 id="列表视图与详情视图通用："><a href="#列表视图与详情视图通用：" class="headerlink" title="列表视图与详情视图通用："></a>列表视图与详情视图通用：</h3><ul>
<li><strong>queryset</strong>列表视图的查询集</li>
<li><strong>serializer_class</strong>视图使用的序列化器</li>
</ul>
</li>
<li><h3 id="详情页视图使用："><a href="#详情页视图使用：" class="headerlink" title="详情页视图使用："></a>详情页视图使用：</h3><ul>
<li><strong>lookup_field</strong>查询单一数据库对象时使用的条件字段，默认为’<code>pk</code>‘</li>
<li><strong>lookup_url_kwarg</strong>查询单一数据时URL中的参数关键字名称，默认与<strong>look_field</strong>相同</li>
</ul>
</li>
</ul>
<h5 id="3-Mixin"><a href="#3-Mixin" class="headerlink" title="3. Mixin"></a>3. Mixin</h5><p><strong>注意Mixin  配合GenericAPIView</strong></p>
<ul>
<li><p>1）ListModelMixin</p>
<p>列表视图扩展类，提供<code>list(request, *args, **kwargs)</code>方法快速实现列表视图，返回200状态码。</p>
<p>该Mixin的list方法会对数据进行过滤和分页。</p>
</li>
<li><p>2）CreateModelMixin</p>
<p>创建视图扩展类，提供<code>create(request, *args, **kwargs)</code>方法快速实现创建资源的视图，成功返回201状态码。</p>
<p>如果序列化器对前端发送的数据验证失败，返回400错误</p>
</li>
<li><p><strong><a target="_blank" rel="noopener" href="http://www.django-rest-framework.org/api-guide/generic-views/#mixins">详情文档</a></strong></p>
</li>
</ul>
<h5 id="4-子类视图-三级"><a href="#4-子类视图-三级" class="headerlink" title="4. 子类视图(三级)"></a>4. 子类视图(三级)</h5><ul>
<li><p>ListAPIView</p>
<p><img src="https://qny.jkraise.top/Django-knowledge/1624326579016.png" alt="1624326579016"></p>
</li>
<li><p>添加路由</p>
<p><img src="https://qny.jkraise.top/Django-knowledge/1624408527701.png" alt="1624408527701"></p>
</li>
</ul>
<h5 id="视图集ViewSet"><a href="#视图集ViewSet" class="headerlink" title="视图集ViewSet"></a>视图集ViewSet</h5><ul>
<li>实现所有的增，删，改，查，查一个</li>
</ul>
<p><img src="https://qny.jkraise.top/Django-knowledge/1625022115613.png" alt="1625022115613"></p>
<h5 id="drf-缓存使用"><a href="#drf-缓存使用" class="headerlink" title="drf 缓存使用"></a>drf 缓存使用</h5><p>安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip3 install drf-extensions</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>1.装饰器的方式</strong></p>
<p><img src="https://qny.jkraise.top/Django-knowledge/1626680437193.png" alt="1626680437193"></p>
<ul>
<li><p>它可以接收两个参数</p>
<p><img src="https://qny.jkraise.top/Django-knowledge/1626680526839.png" alt="1626680526839"></p>
</li>
<li><p><img src="https://qny.jkraise.top/Django-knowledge/1626680712990.png" alt="1626680712990"></p>
</li>
</ul>
<p>**继承视图 CacheResponseMixin **</p>
<ul>
<li><p>setting 设置缓存时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># drf缓存时间</span><br><span class="line">REST_FRAMEWORK_EXTENSIONS &#x3D; &#123;</span><br><span class="line">    # 设置为5秒</span><br><span class="line">    &#39;DEFAULT_CACHE_RESPONSE_TIMEOUT&#39;: 5</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>官网文档:<a target="_blank" rel="noopener" href="http://chibisov.github.io/drf-extensions/docs">http://chibisov.github.io/drf-extensions/docs</a> </p>
</li>
</ul>

    </div>
    <div>    
    
      <div>    
	        
		<div style="text-align:center;color: #ccc;font-size:14px;">------ 本文结束------		</div>    
	
</div>    
     
    </div>
    
    
    
      

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>zhaokui
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://jkraise.top/2021/06/21/Django-knowledge%20point/" title="Django 知识点">http://jkraise.top/2021/06/21/Django-knowledge point/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Django/" rel="tag"># Django</a>
              <a href="/tags/%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F/" rel="tag"># 商业模式</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/04/11/c++001/" rel="prev" title="c++教程">
      <i class="fa fa-chevron-left"></i> c++教程
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/09/07/vue3.0/" rel="next" title="前端工程化 && vue3.0">
      前端工程化 && vue3.0 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95"><span class="nav-number">1.</span> <span class="nav-text">目录</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.1.</span> <span class="nav-text">商业模式介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-B2B%E2%80%93%E4%BC%81%E4%B8%9A%E5%AF%B9%E4%BC%81%E4%B8%9A"><span class="nav-number">1.1.1.</span> <span class="nav-text">1. B2B–企业对企业</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-C2C%E2%80%93%E4%B8%AA%E4%BA%BA%E5%AF%B9%E4%B8%AA%E4%BA%BA"><span class="nav-number">1.1.2.</span> <span class="nav-text">2. C2C–个人对个人</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-B2C%E2%80%93%E4%BC%81%E4%B8%9A%E5%AF%B9%E4%B8%AA%E4%BA%BA"><span class="nav-number">1.1.3.</span> <span class="nav-text">3. B2C–企业对个人</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-C2B%E2%80%93%E4%B8%AA%E4%BA%BA%E5%AF%B9%E4%BC%81%E4%B8%9A"><span class="nav-number">1.1.4.</span> <span class="nav-text">4.C2B–个人对企业</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="nav-number">1.2.</span> <span class="nav-text">项目知识点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#live-server%E5%AE%9E%E6%97%B6%E7%AE%80%E6%98%93%E9%9D%99%E6%80%81%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-number">1.2.1.</span> <span class="nav-text">live-server实时简易静态服务器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ubuntu-%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4IP%E5%9C%B0%E5%9D%80"><span class="nav-number">1.2.2.</span> <span class="nav-text">ubuntu  设置默认IP地址</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Django%E8%87%AA%E5%AE%9A%E4%B9%89%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8%E7%B1%BB"><span class="nav-number">1.2.3.</span> <span class="nav-text">Django自定义文件存储类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CKEditor-%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8"><span class="nav-number">1.2.4.</span> <span class="nav-text">CKEditor 富文本编辑器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E-%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2%E6%96%B9%E6%A1%88Elasticsearch"><span class="nav-number">1.2.5.</span> <span class="nav-text">搜索引擎(全文检索方案Elasticsearch)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8Docker%E5%AE%89%E8%A3%85Elasticsearch"><span class="nav-number">1.3.</span> <span class="nav-text">使用Docker安装Elasticsearch</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Haystack%E4%BB%8B%E7%BB%8D%E5%92%8C%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE"><span class="nav-number">1.4.</span> <span class="nav-text">Haystack介绍和安装配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E9%9D%99%E6%80%81%E5%8C%96"><span class="nav-number">1.4.1.</span> <span class="nav-text">页面静态化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="nav-number">1.4.2.</span> <span class="nav-text">购物车</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ubuntu-%E7%BD%91%E5%8D%A1%EF%BC%8C%E6%9C%89%E6%97%B6%E7%BC%BA%E5%B0%91-ens33"><span class="nav-number">1.4.3.</span> <span class="nav-text">ubuntu 网卡，有时缺少 ens33</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-Win10-%E4%B8%8E-Ubuntu16-04-%E4%B9%8B%E9%97%B4%E5%AE%9E%E7%8E%B0%E7%B2%98%E8%B4%B4%E5%A4%8D%E5%88%B6"><span class="nav-number">1.4.4.</span> <span class="nav-text">解决 Win10 与 Ubuntu16.04 之间实现粘贴复制</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ubuntu%E5%AE%89%E8%A3%85-%E7%BD%91%E7%BB%9C%E7%9B%B8%E5%85%B3%E7%9A%84%E5%8C%85-apt-install-netscript"><span class="nav-number">1.4.4.1.</span> <span class="nav-text">ubuntu安装 网络相关的包 apt install netscript</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%9E%E5%B9%82%E7%AD%89-amp-%E5%B9%82%E7%AD%89"><span class="nav-number">1.4.5.</span> <span class="nav-text">非幂等&amp;幂等</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Django-%E4%BA%8B%E5%8A%A1%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.4.6.</span> <span class="nav-text">Django 事务的使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E4%B9%90%E8%A7%82%E9%94%81%E5%B9%B6%E5%8F%91%E4%B8%8B%E5%8D%95"><span class="nav-number">1.4.7.</span> <span class="nav-text">使用乐观锁并发下单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MySQL%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">1.4.8.</span> <span class="nav-text">MySQL事务隔离级别</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Django-%E6%8E%A5%E5%85%A5-%E6%94%AF%E4%BB%98-%E6%94%AF%E4%BB%98%E5%AE%9D%E4%B8%BA%E4%BE%8B"><span class="nav-number">1.5.</span> <span class="nav-text">Django 接入 支付(支付宝为例)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1-%E6%B5%8B%E8%AF%95"><span class="nav-number">1.5.0.1.</span> <span class="nav-text">开发服务-测试</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%94%AF%E4%BB%98%E5%AE%9D%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3"><span class="nav-number">1.5.0.2.</span> <span class="nav-text">支付宝开发文档</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AERSA2%E5%85%AC%E7%A7%81%E9%92%A5"><span class="nav-number">1.6.</span> <span class="nav-text">配置RSA2公私钥</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E6%97%B6%E6%B3%A8%E6%84%8F"><span class="nav-number">1.6.0.1.</span> <span class="nav-text">调用时注意</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E9%83%A8%E7%BD%B2"><span class="nav-number">1.7.</span> <span class="nav-text">后台部署</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%83%E7%94%A8Django%E8%87%AA%E5%B8%A6%E7%9A%84admin%EF%BC%8C%E4%BD%BF%E7%94%A8%E6%89%A9%E5%B1%95-xadmin"><span class="nav-number">1.7.1.</span> <span class="nav-text">弃用Django自带的admin，使用扩展 xadmin</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-ubuntu18-04-pip-install-https-github-com-sshwsfc-xadmin-tarball"><span class="nav-number">1.7.1.1.</span> <span class="nav-text">安装  ubuntu18.04  pip install https:&#x2F;&#x2F;github.com&#x2F;sshwsfc&#x2F;xadmin&#x2F;tarball&#x2F; </span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C%E5%BA%94%E7%94%A8"><span class="nav-number">1.7.1.2.</span> <span class="nav-text">注册应用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%81%E7%A7%BBXadmin%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.7.1.3.</span> <span class="nav-text">迁移Xadmin数据库</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mysql-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%BB%E4%BB%8E"><span class="nav-number">1.7.2.</span> <span class="nav-text">mysql 数据库主从</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%83%AD%E5%A4%87%E4%BB%BD-%E4%B8%BB%E6%9C%BA%E4%B8%8D%E5%81%9C%E6%9C%BA%EF%BC%8C%E5%AE%9E%E6%97%B6%E5%B0%86%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E7%BB%99%E4%BB%8E%E6%9C%BA"><span class="nav-number">1.7.2.1.</span> <span class="nav-text">热备份 主机不停机，实时将数据备份给从机</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%86%B7%E5%A4%87%E4%BB%BD-%E4%B8%BB%E6%9C%BA%E9%9C%80%E8%A6%81%E5%81%9C%E6%9C%BA%EF%BC%8C%E5%86%8D%E5%B0%86%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E7%BB%99%E4%BB%8E%E6%9C%BA"><span class="nav-number">1.7.2.2.</span> <span class="nav-text">冷备份   主机需要停机，再将数据备份给从机</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8"><span class="nav-number">2.</span> <span class="nav-text">序列化器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E5%AE%89%E8%A3%85"><span class="nav-number">2.0.0.1.</span> <span class="nav-text">1.  安装</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E5%88%9B%E5%BB%BA%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8"><span class="nav-number">2.0.0.2.</span> <span class="nav-text">3. 创建序列化器</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%A4%E7%82%B9%E8%AF%B4%E6%98%8E%EF%BC%9A"><span class="nav-number">2.0.1.</span> <span class="nav-text">两点说明：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E7%B1%BB%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8ModelSerializer"><span class="nav-number">2.0.2.</span> <span class="nav-text">模型类序列化器ModelSerializer</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ModelSerializer%E4%B8%8E%E5%B8%B8%E8%A7%84%E7%9A%84Serializer%E7%9B%B8%E5%90%8C%EF%BC%8C%E4%BD%86%E6%8F%90%E4%BE%9B%E4%BA%86%EF%BC%9A"><span class="nav-number">2.0.2.1.</span> <span class="nav-text">ModelSerializer与常规的Serializer相同，但提供了：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81"><span class="nav-number">2.0.2.2.</span> <span class="nav-text">代码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA"><span class="nav-number">2.0.2.3.</span> <span class="nav-text">演示</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8%E5%85%B3%E8%81%94%E7%9A%84%E5%A4%96%E9%94%AE%E5%86%99%E6%B3%95"><span class="nav-number">2.0.2.4.</span> <span class="nav-text">序列化器关联的外键写法</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE"><span class="nav-number">2.0.3.</span> <span class="nav-text">视图</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-APIView-%E4%B8%80%E7%BA%A7"><span class="nav-number">2.0.3.1.</span> <span class="nav-text">1. APIView(一级)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%94%AF%E6%8C%81%E5%AE%9A%E4%B9%89%E7%9A%84%E5%B1%9E%E6%80%A7%EF%BC%9A"><span class="nav-number">2.0.3.2.</span> <span class="nav-text">支持定义的属性：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-GenericAPIView-%E4%BA%8C%E7%BA%A7"><span class="nav-number">2.0.3.3.</span> <span class="nav-text">2. GenericAPIView(二级)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%94%AF%E6%8C%81%E5%AE%9A%E4%B9%89%E7%9A%84%E5%B1%9E%E6%80%A7%EF%BC%9A-1"><span class="nav-number">2.0.3.4.</span> <span class="nav-text">支持定义的属性：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%97%E8%A1%A8%E8%A7%86%E5%9B%BE%E4%B8%8E%E8%AF%A6%E6%83%85%E8%A7%86%E5%9B%BE%E9%80%9A%E7%94%A8%EF%BC%9A"><span class="nav-number">2.1.</span> <span class="nav-text">列表视图与详情视图通用：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%A6%E6%83%85%E9%A1%B5%E8%A7%86%E5%9B%BE%E4%BD%BF%E7%94%A8%EF%BC%9A"><span class="nav-number">2.2.</span> <span class="nav-text">详情页视图使用：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-Mixin"><span class="nav-number">2.2.0.1.</span> <span class="nav-text">3. Mixin</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-%E5%AD%90%E7%B1%BB%E8%A7%86%E5%9B%BE-%E4%B8%89%E7%BA%A7"><span class="nav-number">2.2.0.2.</span> <span class="nav-text">4. 子类视图(三级)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE%E9%9B%86ViewSet"><span class="nav-number">2.2.0.3.</span> <span class="nav-text">视图集ViewSet</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#drf-%E7%BC%93%E5%AD%98%E4%BD%BF%E7%94%A8"><span class="nav-number">2.2.0.4.</span> <span class="nav-text">drf 缓存使用</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="zhaokui"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">zhaokui</p>
  <div class="site-description" itemprop="description">There is something inside ,that they can'tgetto,that they can't touch. hat's yours.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">33</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">45</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">52</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/joinik" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;joinik" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:wyun4779@gmail.com" title="E-Mail → mailto:wyun4779@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhaokui</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">104k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">1:34</span>
</div>
<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">滇ICP备2020008246号</a>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='120,120,120' opacity='0.5' zIndex='-1' count='180' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'http://jkraise.top/2021/06/21/Django-knowledge%20point/',]
      });
      });
  </script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'wWb2h4bVCBn9NieF9oqmmE5s-gzGzoHsz',
      appKey     : 'bXN3qe3YfOw2f8gOgbO0JA8R',
      placeholder: "你的言论将上交国家,请注意文明用言,否则可能被拒收或查水表 ヾﾉ≧∀≦)o 来呀！吐槽一番吧！",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/miku.model.json"},"display":{"position":"right","width":200,"height":400},"mobile":{"show":false},"react":{"opacity":0.8},"log":false});</script></body>
</html>
